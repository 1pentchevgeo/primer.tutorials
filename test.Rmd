---
title: "test"
author: "Nosa Lawani"
date: "5/24/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
shaming %>% 
  mutate(id = 1:length(primary_06)) %>% 
  pivot_longer(cols = primary_00:general_04,
               names_to = "year",
               values_to = "voted") %>% 
  mutate(voted = if_else(voted == "Yes", 1, 0)) %>% 
  pivot_wider(names_from = year, 
              values_from = voted) %>% 
  rowwise() %>% 
  mutate(vote_sum = sum(primary_00, general_00, primary_02, general_02, primary_04, general_04)) %>% 
  mutate(vote_sum = as.character(vote_sum),
         primary_06 = as.character(primary_06)) %>% 
  select(age, vote_sum, primary_06) %>% 
  drop_na() %>% 
  ggplot(aes(x = age, y = vote_sum)) +
  stat_slab() +
  theme_classic() +
  labs(title = "Age Distributions by Voting History",
       subtitle = "Those who have voted less are younger", 
       x = "Age", 
       y = "Number of Times Voted", 
       caption = "Gerber, Green, and Larimer (2008)") +
  coord_cartesian(xlim = c(18, 90))
```

```{r}
kenya_p <- kenya %>% 
  mutate(poverty_groups = case_when(poverty >= .18 & poverty < .35 ~ "1st Quartile",
            poverty >= .35 &  poverty < .43  ~ "2nd Quartile",
            poverty >= .43 & poverty < .49 ~ "3rd Quartile",
            poverty >= .49 ~ "4th Quartile")) %>% 
  mutate(age_groups = case_when(mean_age < 41.5  ~ "1st Half",
                                     mean_age >= 41.5  ~ "2nd Half")) %>% 
  select(reg_byrv13, treatment, poverty_groups, age_groups) %>% 
  drop_na() %>%
  ggplot(aes(reg_byrv13, poverty_groups, fill = age_groups)) +
  stat_halfeye(position = "dodge") +
  coord_cartesian(xlim = c(0, .06)) +
  scale_x_continuous(labels = scales::percent_format()) +
  scale_y_discrete(labels = c("1st Quartile (Least Poverty)", "2nd Quartile", "3rd Quartile", "4th Quartile (Most Poverty)")) +
  labs(title = "Distribution of New Registered Voters by Poverty and Age Groups",
       subtitle = "Poorer and older districts have a greater percentage of 
new registered voters",
       x = "Percent of New Registered Voters", 
       y = "Poverty", 
       fill = "Mean Age") +
  theme_classic()

kenya_p
```

```{r}
qscores %>% 
 mutate(enrollment_groups = case_when(enrollment >= 16 & enrollment < 30 ~ "16-30",
            enrollment >= 30 &  enrollment < 50  ~ "30-45",
            enrollment >= 50 & enrollment < 100 ~ "45-60",
            enrollment >= 100 ~ "100+")) %>% 
  mutate(introduction = str_detect(name, "Introduction")) %>% 
  ggplot(aes(rating, enrollment_groups, fill = introduction)) +
  stat_halfeye(position = "dodge") + 
  coord_cartesian(xlim = c(2.7, 5)) +
  scale_y_discrete(limits = c("16-30", "30-45", "45-60", "100+")) +
  labs(title = "Ratings Distribution by Enrollment", 
       subtitle = 'Classes of Higher Enrollment and "Introduction" Classses Have
Lower Ratings',
x = "Rating", 
y = "Entollment",
caption = "Harvard College", 
fill = '"Introduction" in Course Title') +
  theme_classic()
```
```{r}
nominate %>% 
  filter(party %in% c("Democrat", "Republican")) %>%
  mutate(Economic = nominate_dim1,
         Social = nominate_dim2) %>% 
  pivot_longer(cols = Economic:Social,
               names_to = "type",
               values_to = "value") %>% 
  drop_na() %>% 
ggplot(aes(x = congress, y = value, color = party)) +
  geom_dots() +
    facet_wrap(~type) +
  scale_color_manual(values = c("#00BFC4", "#F8766D")) +
  labs(title = "Ideologocial Position of Democratts and Republicans",
       subtitle = "Economic positions of different parties tend to move in opposite directions", 
       x = "Session of Congress", 
       y = "", 
       caption = "Source: Voteview") +
  scale_y_continuous(labels = c("-1.0 (Leftmost)", "-0.5", "0.0", "0.5", "1.0 (Rightmost)")) +
  theme_classic()
       
```

```{r}
quantile(kenya$poverty, probs = seq(0, 1, .25))
quantile(kenya$distance, probs = seq(0, 1, .25))
quantile(kenya$mean_age, probs = seq(0, 1, .5), na.rm = TRUE)

kenya

```

```{r}
kenya %>% 
  mutate(poverty_groups = case_when(poverty >= .18 & poverty < .35 ~ "1st Quartile",
            poverty >= .35 &  poverty < .43  ~ "2nd Quartile",
            poverty >= .43 & poverty < .49 ~ "3rd Quartile",
            poverty >= .49 ~ "4th Quartile")) %>% 
  mutate(age_groups = case_when(mean_age < 41.5  ~ "1st Half",
                                     mean_age >= 41.5  ~ "2nd Half")) %>% 
  select(reg_byrv13, treatment, poverty_groups, age_groups) %>% 
  drop_na() %>%
  ggplot(aes(reg_byrv13, poverty_groups, fill = age_groups)) +
  stat_halfeye(position = "dodge") +
  coord_cartesian(xlim = c(0, .06)) +
  scale_x_continuous(labels = scales::percent_format()) +
  labs(title = "Distribution of New Registered Voters by Poverty and Age Groups",
       subtitle = "Poorer and younger districts have smaller percentage of 
new registered voters",
       x = "Percent of New Registered Voters", 
       y = "Poverty", 
       fill = "Mean Age") +
  theme_classic()
```
```{r}
nhanes %>% 
  select(bmi, gender, depressed) %>% 
  drop_na(depressed, bmi) %>% 
  ggplot(aes(x = bmi, y = depressed, fill = gender)) +
  stat_slab(alpha = .5)  +
  coord_cartesian(xlim = c(16, 60)) +
  scale_y_discrete(labels = c("No Days", "Several Days", "Most Days")) +
  labs(title = "BMI and Days Depressed",
       subtitle = "Most often depressed females of higher BMI than most often depressed males", 
       x = "BMI", 
       y = "Days Depressed", 
       fill = "Sex",
       caption = "National Health and Nutrition Examination Survey") +
  theme_classic() 
```
```{r}
shaming %>% 
  mutate(id = length(primary_06)) 
```

