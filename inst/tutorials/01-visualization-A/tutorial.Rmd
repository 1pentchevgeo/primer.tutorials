---
title: "Visualization-A"
tutorial:
  id: "01-visualization-a"
output: 
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
description: "Chapter 1 Tutorial Part A"
---


```{r setup, include = FALSE}
library(tidyverse)
library(primer.tutorials)
library(primer.data)
library(learnr)



knitr::opts_chunk$set(echo = FALSE, message = FALSE)
options(tutorial.exercise.timelimit = 60, tutorial.storage="local")  
```


## Name

``` {r name}
question_text(
  "Student Name:",
  answer(NULL, correct = TRUE),
  allow_retry = TRUE,
  try_again_button = "Modify your answer",
  incorrect = "Ok"
)
```


## Email

``` {r email}
question_text(
  "Email:",
  answer(NULL, correct = TRUE),
  allow_retry = TRUE,
  try_again_button = "Modify your answer",
  incorrect = "Ok"
)
```


## How do I code in R?
###


### Exercise 1

Before you start coding, you must load the packages you are going to use. In the code chunk below, use the function `library()` to load the `tidyverse` package.

```{r howtc-1, exercise = TRUE}

```

```{r howtc-hint, eval = FALSE}
Place tidyverse inside the library() function.
```

### Exercise 2

If you are ever stuck while coding, R has **help pages**. Let's say we want to know what the function `sqrt()` does. Open the help page for `sqrt()` by typing `?sqrt()` below.

```{r howtc-2, exercise = TRUE}

```

### Exercise 3

Recall **code comments** are text placed after a `#` symbol. Nothing will be run after a `#` symbol, which is useful if you want to write human readable comments in your code..

Press Run Code. Afterwards, delete the `#` and re-run the chunk. You should see a result.

```{r howtc-3, exercise = TRUE}
# sqrt(144)
```

### Exercise 4

Let's save the values of `sqrt(144)` to an object named `results`. Remember to use the assignment operator `<-`. 

```{r howtc-4, exercise = TRUE}

```

```{r howtc-4-hint, eval = FALSE}
results <- sqrt(144)
```

### Exercise 5

A **vector** is a series of values that are created using the `c()` function. Create a vector that contains the integers from one to ten.

```{r howtc-5, exercise = TRUE}

```

```{r howtc-5-hint, eval = FALSE}
Type the values 1-10 inside the function c().
```

### Exercise 6

If your vector contains a sequence of contiguous integers, you can create it with the `:` shortcut. Run `1:10` in the chunk below.

```{r howtc-6, exercise = TRUE}

```

### Exercise 7

You can extract any element of a vector by placing a pair of brackets `[ ]` behind the vector. Inside the brackets, place the number of the element that you'd like to extract. For example, `vec[3]` would return the third element of the vector named `vec`.

The code below assigns a vector to an object named `vec`. Use the chunk below to extract the fourth element of `vec`.

```{r howtc-7, exercise = TRUE}
vec <- c(1, 2, 4, 8, 16)
```

```{r howtc-7-hint, eval = FALSE}
vec[...]
```

### Exercise 8

You can also use `[ ]` to extract multiple elements of a vector. Place the vector `c(1,2,5)` between the brackets below. What does R return?

```{r howtc-8, exercise = TRUE}
vec <- c(1, 2, 4, 8, 16)
vec[]
```

### Exercise 9

If the elements inside your vector have names, you can extract them by name. To do so, place a name or vector of names in the brackets behind a vector. Surround each name with quotation marks, e.g. `vec2[c("alpha", "beta")]`.

Below the given code, extract the element named "gamma" from the vector below.

```{r howtc-9, exercise = TRUE}
vec2 <- c(alpha = 1, beta = 2, gamma = 3)

```

```{r howtc-9-hint, eval = FALSE}
Because the names are characters, make sure to use quotation marks inside the brackets, i.e. vec2["..."].
```



## Exploring Data Frames

Data frames, also referred to as "tibbles", are spreadsheet-type data sets. R comes with many toy **data sets** to explore.

### Exercise 1

It's always a good idea to explore the data before you use it. You can simply examine a dataset by typing its name. Let's examine the contents of `iris` data set. Type `iris` in the line below.

```{r df-1, exercise = TRUE}

```

### Exercise 2

Now use `glimpse()` to look at the `trains` data set.

```{r df-2, exercise = TRUE}

```

```{r df-2-hint, eval = FALSE}
Place iris inside the glimpse() function.
```

### Exercise 3

Data frames can be created using `tibble()`. Below the given code, assemble the vectors below into a data frame using `tibble()`.

```{r df-3, exercise = TRUE}
nums <- c(1, 2, 3, 4)
logs <- c(TRUE, TRUE, FALSE, TRUE)
strs <- c("apple", "banana", "carrot", "duck")
```

```{r df-3-hint, eval = FALSE}
Place `nums`, `logs` and `strs` all inside `tibble()`. 
```

### Exercise 4

As you can see, when we use the `tibble()` function, we can see the tibble. However, when we assign the tibble to an object, we do not see the actual tibble. That is because we are just running the code to assign the values. 

Run the code below. Notice how nothing prints out for us to see.

```{r df-4-setup}
nums <- c(1, 2, 3, 4)
logs <- c(TRUE, TRUE, FALSE, TRUE)
strs <- c("apple", "banana", "carrot", "duck")
```

```{r df-4, exercise = TRUE}
data_f <- tibble(nums, logs, strs)
```

### Exercise 5

After you assign values to an object, you must type the name of the object to actually see results. Now run the code below. Notice that we can now see results.

```{r df-5-setup}
nums <- c(1, 2, 3, 4)
logs <- c(TRUE, TRUE, FALSE, TRUE)
strs <- c("apple", "banana", "carrot", "duck")
```

```{r df-5, exercise = TRUE}
data_f <- tibble(nums, logs, strs)
data_f
```

### Exercise 6

The `$` operator is a great tool to extract columns as vectors. Extract the `strs` column of the `data_f` data frame using the `$` operator.

```{r df-6-setup}
nums <- c(1, 2, 3, 4)
logs <- c(TRUE, TRUE, FALSE, TRUE)
strs <- c("apple", "banana", "carrot", "duck")
data_f <- tibble(nums, logs, strs)
```

```{r df-6, exercise = TRUE}

```

```{r df-6-hint-1, eval = FALSE}
data_f$...
```

```{r df-6-hint-2, eval = FALSE}
See the Primer for guidance!
```


## `geom_point` 

Scatterplots allow you to visualize the relationship between two numerical variables. 

Let's create the following scatterplot. 

```{r scat-p}
scat_p <- ggplot(data = iris, 
                 mapping = aes(x = Sepal.Length, 
                               y = Sepal.Width, 
                              color = Species)) +
  geom_point() +
  labs(title = "Measurements for Different Species of Iris",
        x = "Sepal.Length",
        y = "Sepal.Width")

scat_p
```


### Exercise 1

Let's first `view()` the data set used above called `iris`.

```{r gp-1, exercise = TRUE}

```

```{r gp-1-hint, eval = FALSE}
view(...)
```

### Exercise 2

Within `ggplot()`, set `data` to `iris`. Also, map `Sepal.Length` to the x-axis and `Sepal.Width` to the y-axis. Add the layer `geom_point()`.

```{r gp-2, exercise = TRUE}

```

```{r gp-2-hint-1, eval = FALSE}
Remember when you add a layer you use +. 
```

```{r gp-2-hint-2, eval = FALSE}
ggplot(data = iris, 
       mapping = aes(x = ..., 
                     y = ...)) + 
    geom_point()
```

### Exercise 3

Awesome! Now we want to add a `color` aesthetic based on the different species of the iris flower. Set the argument `color` to `species` inside the `aes()` function.

```{r gp-3, exercise = TRUE}

```

```{r gp-3-hint, eval = FALSE}
ggplot(data = iris, 
       mapping = aes(x = Sepal.Length, 
                     y = Sepal.Width, 
                     color = ...)) 
```

### Exercise 4

Now use `labs()` to add a title and axis labels to the graph. Title your graph "Measurements for Different Species of Iris". Label the 
x-axis "Sepal.Length" and y-axis "Sepal.Width".

```{r gp-4, exercise = TRUE }

```

```{r gp-4-hint, eval = FALSE}
Remember to add a layer with the function labs()
```
        
Reminder: This is what our graph should look like.

```{r}
scat_p
```       

### Exercise 5

Sometimes graphs have overplotting. The following code uses the `mpg` tibble to create a scatterplot that displays 126 points. However, it visualizes a data set that contains 234 points. The missing points are hidden behind other points.

Run the code below to see the scatterplot. 

```{r gp-5, exercise = TRUE}
ggplot(data = mpg, 
       mapping = aes(x = displ, 
                     y = hwy)) +
  geom_point()
```

### Exercise 6

One method to fight overplotting is to make each point **semi-transparent**. The code chunk below provides the code used to create the graph above. Change the transparency of the points by setting `alpha = 0.2` within `geom_point()`.

```{r gp-6, exercise = TRUE}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point()
```

```{r gp-6-hint, eval = FALSE}
ggplot(data = mpg, 
       mapping = aes(x = displ, y = hwy)) +
  geom_point(alpha = ...)
```


##`geom_jitter()` 

We can also use `geom_jitter()` to fight overplotting. It plots a scatterplot and then adds a small amount of random noise to each point in the plot. 


### Exercise 1

Run the code below that creates a scatterplot with overplotting. 

```{r gj-1, exercise = TRUE}
ggplot(data = trains, 
       mapping = aes(x = att_start, 
                     y = att_end)) +
  geom_point()
```

### Exercise 2

Let's now replace `geom_point()` with `geom_jitter()`. 

```{r gj-2, exercise = TRUE}
ggplot(data = trains, 
       mapping = aes(x = att_start, 
                     y = att_end)) + 
  geom_point()
```

### Exercise 3

Within `geom_jitter()`, set `width` to `.2` to adjust the amount the points are jittered.

```{r gj-3, exercise = TRUE}

```

```{r gj-3-hint, eval = FALSE}
ggplot(data = trains, 
       mapping = aes(x = att_start, 
                     y = att_end)) +
  geom_jitter(width = ...)

```

### Exercise 4

Inside the `aes()` argument, set the `color` aesthetic to the `party` variable. 

```{r gj-4, exercise = TRUE}

```


```{r gj-4-hint, eval = FALSE}
ggplot(data = trains, 
       mapping = aes(x = att_start, 
                     y = att_end, 
                     color = ...)) +
  geom_jitter(width = .2)
```

### Exercise 5

As a final exercise, use what you've learned to recreate the plot below. The graph was created using the data set `diamonds`. The `alpha` of the plot is 0.2, and the `width` of the jitter distribution is 5. Use the `labs()` function to add the titles and labels.

```{r}
ggplot(data = diamonds, mapping = aes(x = depth, y = price)) +
  geom_jitter(width = 5, alpha = 0.2) +
  labs(title = "Depth and Price in Diamonds",
       x = "Depth",
       y = "Price")
```

```{r gj-1-5, exercise = TRUE}

```

```{r gj-1-5-hint, eval = FALSE}
ggplot(data = diamonds, 
       mapping = aes(x = ..., 
                     y = ...)) +
  geom_jitter(width = ..., 
              alpha = ...) +
  labs(title = "...",
       x = "...",
       y = "...")
```

## ` geom_histogram()` 

A histogram is a plot that visualizes the distribution of a numerical variable. 

Let's create the following histogram.

```{r}
hist_p <- ggplot(data = qscores, 
                 mapping = aes(x = rating)) +
        geom_histogram(binwidth = 1, 
                       color = "white", 
                       bins = 10)

hist_p
```

### Exercise 1

Within `ggplot()`, set `data` to `qscores`. Map `rating` to the x-axis to see the distribution of Harvard course ratings. Add the layer `geom_histogram()`.

```{r gh-1, exercise = TRUE}

```

```{r gh-1-hint, eval = FALSE}
ggplot(data = ..., 
       mapping = aes(x = ...)) + 
  geom_histogram
```

### Exercise 2

Add white vertical borders demarcating the bins by adding `color = "white"` to `geom_histogram()`.

```{r gh-2, exercise = TRUE}

```

```{r gh-2-hint, eval = FALSE}
ggplot(data = qscores, 
       mapping = aes(x = rating)) +
  geom_histogram(color = ...)
```

### Exercise 3

Specify the number of bins to be 10 using the `bins` argument in `geom_histogram()`.

```{r gh-3, exercise = TRUE}

```

```{r gh-3-hint, eval = FALSE}
ggplot(data = qscores, 
       mapping = aes(x = rating)) +
  geom_histogram(color = "white",
                 bins = 10)
```

### Exercise 4

Set the width of the bins to be 1 using the `binwidth` argument.

```{r gh-4, exercise = TRUE}

```

Reminder: This is what our graph should look like.

```{r}
hist_p
```


```{r gh-4-hint, eval = FALSE}
ggplot(data = qscores, 
       mapping = aes(x = rating)) +
  geom_histogram(color = "white", 
                 bins = 10, 
                 binwidth = 1)
```



## `geom_bar()`

A barplot is a plot that visualizes the distribution of a categorical variable. 

Let's create the following barplot. 

```{r}
bar_p <- ggplot(data = trains, 
       mapping = aes(x = treatment, 
                     fill = party)) +
  geom_bar(position = "dodge")

bar_p
```

### Exercise 1

Use the `trains` data set in the `primer.data` package. Use `ggplot()` and `geom_bar()` to plot `treatment` on the x-axis.

```{r gb-1, exercise = TRUE}

```

```{r gb-1-hint, eval = FALSE}
ggplot(data = ..., 
       mapping = aes(x = ...)) + 
  ...
```

### Exercise 2

Let's now map the additional variable `party` to the `fill` argument inside `aes()`.

```{r gb-2, exercise = TRUE}

```

```{r gb-2-hint, eval = FALSE}
ggplot(data = trains, 
       mapping = aes(x = treatment, 
                     fill = ...)) + 
  geom_bar()
```

### Exercise 3

Let's make our graph a side-by-side barplot. Set `position` to "dodge" in `geom_bar()`.

```{r gb-3-hint, eval = FALSE}
ggplot(data = trains, 
       mapping = aes(x = treatment, 
                     fill = party)) +
  geom_bar(position = ...)
```

```{r gb-3, exercise = TRUE}

```

Reminder: This is what our graph should look like.

```{r}
bar_p
```



## `geom_smooth()` 

We can add a regression line to our scatterplots using `geom_smooth()`


### Exercise 1

Run the code below to see a scatterplot using the `nhanes` dataset.

```{r gs-1, exercise = TRUE, warning = FALSE}
ggplot(data = nhanes, 
       mapping = aes(x = weight, 
                     y = height)) +
  geom_point()

```

### Exercise 2

Now add `geom_smooth()` to the graph. Remember you are adding a layer so you need to include `+`. 

```{r gs-2, exercise = TRUE, warning = FALSE}
ggplot(data = nhanes, 
       mapping = aes(x = weight, 
                     y = height)) +
  geom_point()

```

### Exercise 3

Awesome! Let's try setting the method to "lm" inside `geom_smooth()`.

```{r gs-3, exercise = TRUE, warning = FALSE}

```

```{r gs-3-hint, eval = FALSE}
Remember to put "lm" in quotes within geom_smooth()
```

### Exercise 4

Great! Now let's set the `formula` argument to `y ~ x`. Also set `se` to FALSE so no grey area surrounds the trendline.

```{r gs-4, exercise = TRUE, warning = FALSE}


```

```{r gs-4-hint, eval = FALSE}
ggplot(data = nhanes, 
       mapping = aes(x = weight, 
                     y = height)) +
  geom_point() +
    geom_smooth(method = "lm", formula = y ~ x)
```

### Exercise 5

As a final exercise, use what you've learned about `geom_smooth()` to recreate the plot below. The data set used for this scatterplot is `mpg`.

```{r}
ggplot(data = mpg, 
       mapping = aes(x = cty, y = hwy)) + 
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
  labs(title = "City vs. Highway Fuel Economy",
       x = "City Miles Per Gallon",
       y = "Highway Miles Per Gallon")
```

```{r gs-5, exercise = TRUE}

```

```{r gs-5-hint, eval = FALSE}
For geom_smooth(): The method should be set to "lm", the formula should be set to y ~ x, and se should be set to FALSE.
```


## `geom_density()`
###

`geom_density()` is used to make a density plot, a smoothed version of a histogram. It is a useful alternative to the histogram that displays continuous data in a smooth distribution.

Let's create the following density plot. 

```{r}
dens_p <- ggplot(data = cces, 
                 mapping = aes(x = age, 
                               color = ideology, 
                               fill = ideology)) +
  geom_density(alpha = .1,)

dens_p
```

### Exercise 1

Use the dataset `cces` to make a density plot with `age` on the x axis. Add the layer `geom_density()`

```{r gd-1, exercise = TRUE}

```


```{r gd-1-hint, eval = FALSE}
ggplot(data = ..., 
       mapping = aes(x = ..., 
                     color = ...) + 
         geom_density()
```

### Exercise 2

Now set the `ideology` variable to the aesthetics `color` and `fill`.

```{r gd-2, exercise = TRIE}

```

```{r gd-2-hint, eval = FALSE}
ggplot(data = cces, 
       mapping = aes(x = ..., 
                     color = ..., 
                     fill = ...)) + 
  geom_density()
```

### Exercise 3

Great! Now set the `alpha` argument in `geom_density()` to 0.1.

```{r gd-3, exercise = TRUE}

```

Reminder: Your graph should look something like this. 

```{r}
dens_p
```



## Submit

Congrats on finishing your first Gov 50 tutorial! You're on your way to being a master in data visualization and wrangling! :)

```{r context="setup"}
submission_ui
```

```{r context="server"}
submission_server()
```
