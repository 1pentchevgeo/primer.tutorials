---
title: "RStudio and Friends"
tutorial:
  id: "rstudio-and-friends"
output:
  learnr::tutorial:
      progressive: true
      allow_skip: true
runtime: shiny_prerendered
description: "Introduction to RStudio, Git, Github, R Markdown and R Pubs."
---

```{r setup, include = FALSE}
library(learnr)
library(primer.tutorials)
library(tidyverse)
library(png)
library(grid)
knitr::opts_chunk$set(echo = FALSE)
options(tutorial.exercise.timelimit = 60, 
        tutorial.storage = "local") 
```

## Information
###

```{r information}
quiz(caption = "",
  question_text(
    "Name:",
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL),
  question_text(
    "Email:",
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL))
```

<!-- This tutorial is a bit of a mess! -->

<!-- Check out the Distill tutorial. That does things the right way! Make this tutorial more like that. Want to cover all the material which we normally just practice in class. -->

<!-- Structure so that the beginning of this tutorial starts where Getting Started finished. First section called Set Up is confirming that your set up is correct. Example: library(tidyverse). Copy/paste result. Then confirm that they issued the blank_state() function. Then set up Github. DONE -->

<!-- rstudioapi::readRStudioPreference(name = "load_workspace", default = "Code failed.") DONE -->

<!-- Then maybe we do three case studies, each of which walks through all the steps. First one does little besides the basics, because it needs 5 questions to walk through .gitignore. Later case studies can go further because they can ask one question about .gitignore. -->

<!-- At the end we need three or four case studies, each of which starts from nothing and then generates something. Be specific in the name of everything. (Similar to how the Distill tutorial gets the user all the way to a website.) First example is an Rpubs. Set up Github repo. Connect to computer. Create Rmd. Make nice plot. Publish it. Add Rproj and rsconnect to .gitignore and so on. May need some screen shots of R pubs questions. Last question is: Paste the url for your R Pub here. -->

<!-- Suggestion: Anmay suggested that it is very annoying to switch back and forth between the Terminal and the Console. So, instead of checking that things are done by using `ls` and `cat` from the Terminal, use `list.files()` and `readLines() %>% head()` from the Console. This also avoids various Windows annoyances. -->

<!-- Add a question which checks that there are no spaces in the path which leads to where projects are stored. (This might not be solvable if a student's user name has a space and she can't change it. But, at least she should be made aware of how dangerous this is.) -->

<!-- Need a section devoted to R scripts. What are they? How do we use them? When should we use them versus using R markdown? -->

## Checking your setup

### Exercise 1

<!-- AG: I'm doing a check for this part of the tutorial because they should have already done all this if they're even seeing this part. -->

In the [Getting Started section](https://ppbds.github.io/primer/getting-started.html), you should have installed the **remotes**, **tidyverse**, **usethis**, and **primer.tutorials** packages and then loaded them into R by using the `library()` command.

Type `search()` in the Console to see the libraries that you've currently loaded, then copy and paste the result into the tutorial into the space below. There should be strings such as "package:tidyverse" and "package:remotes" in the output, showing that they've been loaded.

```{r setup-1}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 3))
```

###

### Exercise 2

We're also going to be working from a blank slate for every project. This makes it easier to repeat analyses without outside factors affecting your program. You should have already done this as part of the Getting Started section.

Copy and paste (or type) `rstudioapi::readRStudioPreference(name = "load_workspace", default = "Code failed.")` into the console, then copy and paste the command and the result into the space below. It should return FALSE.

```{r setup-2}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 3))
```

## Setting up Github

<!-- AG: All of the Github tutorials are basically a repeat of the Github section in Tools. This is kind of weird and could be repetitive if both this tutorial and the Github section are assigned because they already did everything. For now though, I'm just going to put the images and checks in the areas that I can. -->

GitHub is, more or less, a Google Drive for all your R code and projects. In the professional world, what you have on your Github account is more important than what you have on your resume because it has all of your projects. 

###

### Exercise 1

The first step to using GitHub is installing Git. If you haven't installed Git, please download it from [here](https://git-scm.com/downloads). You'll be using Git and the Terminal throughout this course to act as version control for your projects. To make sure you have Git, open RStudio on your computer. Click on the Terminal pane, which is next to the Console pane in the lower left portion of RStudio. Type `git --version`  at the Terminal. 

The Terminal tab will have a dollar sign (`$`) as the prompt. If it doesn't have that and instead uses an arrow (`>`), you may have to check your global options.

```{r terminal_example.png}
file <- system.file("images/terminal_example.png",
                    package = "primer.tutorials")

img <- readPNG(file)
grid.raster(img)
```

Copy/paste the result of the git command into the space below.

```{r git-ex-1}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 2))
```

###

### Exercise 2

The next step is creating a GitHub account. To do so, follow the steps [here](https://github.com). Do not proceed with the tutorial until you have created an account.


### Exercise 3

Now that you have your Github account, you need to connect Git and RStudio to your account. Type `git config --global user.name` at the Terminal. It should return your name. If it does not match your name, run `git config --global user.name "Your Name"` in the Terminal, then do the previous command again.

Copy and paste the command and the result into the space below.

```{r git-ex-3}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 2))
```


### Exercise 4

Great. Now type `git config --global user.email` at the Terminal. It should return the same email address you registered with Github. Again, if it does not match your email, run `git config --global user.email "your@email.com"` then run the previous command again.

Copy and paste the command as well as the result into the space below.

```{r git-ex-4}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 2))
```


###

**Note:** You cannot do the following sections of this tutorial if you did not get the correct outputs for the last two exercises.

## GitHub Repositories
###

Github is our Google Drive. Github repositories, or "repos" , are the Google folders where we store our work. Let's make a practice repo!

###

### Exercise 1

To begin, sign into GitHub and go to the homepage. Click the green new button that says "New" on the left. 

```{r new_repo.png}
file <- system.file("images/new_repo.png",
                    package = "primer.tutorials")

img <- readPNG(file)
grid.raster(img)
```


###


### Exercise 2

Name your repository "First_Repo". Then, select the private option for your repo. Also click the box "Add a README file". This is a document where you can add more information.

```{r repo_details.png}
file <- system.file("images/repo_details.png",
                    package = "primer.tutorials")

img <- readPNG(file)
grid.raster(img)
```

<!-- BG: place image here DONE-AG -->

### Exercise 3

The next step will be to download it to your computer — aka “cloning” — and start editing and syncing using Git. To do this, we’ll need to copy the link to the repo and then use it in RStudio. Click on the green button that says "Code". Then copy the link shown. You can use the clipboard button on the right to automatically copy it.

```{r repo_clone.png}
file <- system.file("images/repo_clone.png",
                    package = "primer.tutorials")

img <- readPNG(file)
grid.raster(img)
```

###

## Connecting Github to RStudio

Let's connect your `First_Repo` repository to RStudio.

First off, create a new folder to place your R projects in. Make sure to name it something sensible without spaces or special characters (this makes things easier down the line).


###

### Exercise 1

Open RStudio. Go to File, then New Project.

```{r new_project.png}
file <- system.file("images/new_project.png",
                    package = "primer.tutorials")

img <- readPNG(file)
grid.raster(img)
```

###

### Exercise 2

A window pops up. Select Version Control and then Git.

Paste the link you copied from Github into "Repository URL". Then click "Create Project".

###

Congrats! You’ve linked your repo to RStudio! Github will ask you for a location in which to place this and other projects. We recommend creating a folder on your desktop called “projects” and placing all your RStudio projects there. 


## Updating .gitignore

The first thing you should always do when working with a new repo is updating the `.gitignore` file. You can open this file from the bottom right window under the Files tab. This file includes all the files that you don’t want to be uploaded to GitHub. This can come in handy when you are working with big datasets or files with private information. In our case, we want to add the `firstrepo.Rproj` file to the .gitignore list.

###

### Exercise 1

Open the `.gitignore` and add *.Rproj*  The * tells your computer that we want to prevent all files ending in `.Rproj` from being uploaded. We could also just add `First_Repo.Rproj`.

<!-- BG: place image here DONE-AG-->

```{r rproj.png}
file <- system.file("images/rproj.png",
                    package = "primer.tutorials")

img <- readPNG(file)
grid.raster(img)
```

###

### Exercise 2

Save the `.gitignore` file and you should see the `First_Repo.Rproj` file disappear from your Git tab in the top right window. If you don’t see any changes, click on the refresh button in the upper left.

```{r updated_gitignore.png}
file <- system.file("images/updated_gitignore.png",
                    package = "primer.tutorials")

img <- readPNG(file)
grid.raster(img)
```

Go to the Terminal tab and run `cat .gitignore`. This should output all of the lines in your `.gitignore` file. Copy and paste the command as well as the output into the space below.

```{r gitignore-1}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 2))
```

###

### Exercise 3

Now that we’ve updated our .gitignore file, we want to upload this new version to GitHub. To do so, first select the `.gitignore` file and then click on the `Commit` button in the Git window.

<!-- BG: place image here DONE-AG -->

```{r commit.png}
file <- system.file("images/commit.png",
                    package = "primer.tutorials")

img <- readPNG(file)
grid.raster(img)
```


###

### Exercise 4

This will open a new window where you will write a commit message. The message is meant to note what you’re adding/changing within the repo. Write the commit message "Updating `.gitignore`", then press `Commit`. 

```{r commit_push.png}
file <- system.file("images/commit_push.png",
                    package = "primer.tutorials")

img <- readPNG(file)
grid.raster(img)
```

Run `git log` in the Terminal. This should output the commit that you just did. Copy and paste the command and result into the space below.

```{r gitignore-2}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 2))
```

###

### Exercise 5

Next, press `Push`. This pushes or uploads the files to GitHub! Open up Github and refresh the page to see your commit message at the top of your repo page. 

Run `git log` in the Terminal again. Copy and paste the command and result below.

```{r gitignore-3}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 2))
```

###

Congrats! You just uploaded your first file to GitHub.

## RPubs Publishing

Now it's time to do something cool. Let's go through how we can publish our R projects onto the 

## R Markdown




<!-- ## R Scripts -->


## Download answers

```{r context = "setup"}
submission_ui
```

```{r context = "server"}
submission_server()
```
