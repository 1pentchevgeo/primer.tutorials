---
title: "Distill"
tutorial:
  id: "distill"
output: 
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
description: "Distill Tutorial"
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
options(tutorial.exercise.timelimit = 60, 
        tutorial.storage = "local") 

library(learnr)
library(primer.tutorials)
library(png)
library(grid)
library(tidyverse)
library(distill)
```

## Information
###

```{r information}
quiz(caption = "",
  question_text(
    "Name:",
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL),
  question_text(
    "Email:",
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL))
```

## Creating a Website 
###

We will go over how to make a project in Distill and get it set up with GitHub pages. 

### Exercise 1

In your browser, log in to your Github account. Navigate to your Repositories section. Create a new repository by pressing the green button in the top right of the screen. Give the repo a name and description of your choice and select the option to add a README file. 

###

You will be redirected to the Github page for your new repo. Click the green Code button above where the repo's files are displayed. Copy the link that appears in the dropdown box. 

###

Open RStudio. Click File, then New Project. Select Version Control and then Git. Paste the URL to clone the Github repo into the repository URL box. The name should be automatically filled in based on the name of the repository. In the bottom right corner, select the option to open this project in a new session. 

###

In the Terminal, run `pwd` to confirm that you are in the correct directory, i.e. a directory named after your Github repo in the place you normally keep R projects. Copy and paste the command and result below.

```{r distill-1}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 3))
```

### Exercise 2

In the Terminal, run `ls -a` to view a list of all the files in the directory. You should see a `README.md` which we made when we created the github repo. You should also see two hidden files, `.gitignore` and `.git`. 

###

```{r distill-2}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 3))
```

### Exercise 3

In the Console, load the `usethis` package. Then run the command `git_sitrep()`. Copy and paste the output below. 

```{r distill-3}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 3))
```

###

`git_sitrep()` gives information on the status of Git on your computer and current project. In the "Git repo for current project" section, make sure that the active `usethis` project is set to the correct directory on your computer. 

###

In the Github remote configuration section, make sure that origin is set equal to your github directory and that you have "can push" in parentheses. 

Below is an example of the output of `git_sitrep()` for a working Git repo. Yours should be similar. Do not worry if token scopes differ. 

```{r sitrep.png}
file <- system.file("images/sitrep.png", 
                    package = "primer.tutorials")
img <- readPNG(file)
grid.raster(img)
```

### Exercise 4

To set up and manage the files needed to create a website with R Markdown files, we use the package `distill`. In your console run `install.packages("distill")`. Then use the `library()` function to load the package. 

###

To confirm that you have successfully installed and loaded the package run the function `search()` in your console. Copy and paste the output below. 

```{r distill-4}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 3))
```

###

The output of `search()` is a vector of packages in use. Make sure that "package.distill" is one of the items in the vector. 

### Exercise 5

To add the files necessary to create a website, we use the distill function `create_website()`. Set the first argument, `dir` to `"."`. This tells Distill that we want the files needed for the website in our present working directory. Set the second argument, `title` to a string with what you want to title your website. Set the third argument, `gh_pages` to `TRUE`. This sets up the website to automatically be compatible for hosting with Github Pages. 

###

Executing this command opens a file called `index.Rmd`, which is the code for the home page of your website. At the top of that document, the title field should contain the title you specified in the `create_website()` function. In addition to this document, the function has created several other new files. In the Terminal, run `ls -a` to see a list of all the files in the working directory. Copy and paste the result.
 
```{r distill-5}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 3))
```

###

You should see an `about.Rmd` which, like `index.Rmd` contains the code for your site's about page. 

###

You should see a `_site.yml` sign which contains the instructions for the organization of the different pages of your website. 

###

You should also see a `docs` directory. This is where all the files necessary for the final deploying of your website, including the knitted HTMLs, live. Github Pages looks in the `docs` directory for the components necessary to build the site. 

###

In the same group of panels, where the Git and Environment tabs are, you should also see a Build tab. If you do not, close the RStudio Session for the website (you do not have to close the session in which you are completing the tutorial) and open it again. You should now see a Build tab.

### Exercise 6

In `index.Rmd` replace the example description with a short description of your final project. Knit this file. This opens a preview of what this page of the website will look like.

###

In the Terminal, run `head index.Rmd`. This command prints the first ten lines which should include the text of your new description. Copy and paste the command below. 

```{r distill-6}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 3))
```

###

When you knit a file, you preview how only that page will look on the website. You cannot navigate the website because you have only built one page, not the whole thing. 

### Exercise 7 

Navigate to the Build panel. Hit the "Build Wesbite" button in the top left corner of that panel. This will create a preview of your website with all the pages built. At this point, you should only have a Home page and an About page. You can navigate between these two by clicking the links in the top panel, just as you would on a normal website. 

###

Building the website, rebuilds all the documents necessary to deploy the site, which live in your `docs` directory. In the Terminal, run `ls -l docs`.  Copy and paste the output below.

```{r distill-7}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 3))
```

###

All these files should have very recent and identical times in the date last modified column.

### Exercise 8

Open the `.gitignore` file. In the file, on a new line, add `*.Rproj` to prevent your .Rproj file from being uploaded to Git. Save the file. After it is saved, `.gitignore` should disappear from the Git tab. If it has not, use the refresh button in the top right corner of the panel. 

###

In the Terminal, run `cat .gitignore`. This should return the contents of your edited `.gitignore` file. Copy and paste the output below.

```{r distill-8}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 3))
```

### Exercise 9 

In the Git tab, you should have several uncommited changes. Select all of these and press commit. In the window that pops up, add the commit message "initial commit". Press the commit button. Then press the push button, the green arrow at the top right corner of the screen. When the push is finished, you should have a message that ends with "HEAD -> main". 

###

In the Terminal, run `git log`. Copy and paste the output below. 

```{r distill-9}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 3))
```

### 

The output is a list of your commits. You should see two, the one at the top being the one you just made. Check to see that the time is that of your most recent commit. 

### Exercise 10

In your browser, go to Github. Navigate to the page for your repo. Check to see that the new files we created are now on Github. Navigate to settings, the last item in the same menu where Code (which should be highlighted since you are on that page) is. On the left sidebar menu, click on Pages, which should be towards the bottom. 

###

"None" should be the selected option in the Source section of Github pages. Click on the dropdown menu and choose "main". 

###

A field will appear in which "/root" is the selected option. Click on the dropdown menu and change this to "/docs".  This tells github to build your website from your /docs directory. 

###

Press Save. When you do so, Github will begin to build the website. When it is finished, you will be able to access the site at the link which the page provides. The building process should take fewer than 3 minutes. 

## Adding R Visualizations
###

## Adding a new Page
###

## Using a .RDS
###

## Adding Images and Tables
###

## Adding Citations
###


## Submit

```{r context = "setup"}
submission_ui
```

```{r context = "server"}
submission_server()
```

