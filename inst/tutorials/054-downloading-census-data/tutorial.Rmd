---
title: Downloading Census Data
tutorial:
  id: downloading-census-data
output: 
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
description: Downloading US Census Bureau data into R
---

```{r setup, include = FALSE}
library(learnr)
library(primer.tutorials)
library(tidyverse)
library(primer.data)
library(tidycensus)
knitr::opts_chunk$set(echo = FALSE)
options(tutorial.exercise.timelimit = 60, 
        tutorial.storage = "local") 
```

```{r copy-code-chunk, child = "../../child_documents/copy_button.Rmd"}
```

```{r info-section, child = "../../child_documents/info_section.Rmd"}
```

## Accessing the Census API
###

In this tutorial, we will cover how to download US Census Bureau data into R and then use it to create graphs.

### Exercise 1

First, we need to access the US Census API. We will do this by using the **tidycensus** package. This will allow us to use an API key to then access Census data.

###

Run `install.packages("tidycensus")` in the Console, then load it into your R session using `library(tidycensus)`.

###

Run `search()` in the Console to see the libraries that you've currently loaded, then copy and paste the command and the result into the space below. 

```{r api-access-1}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 3))
```

###

The output should include the string "package:tidycensus" in the output. This will be the main package that we are going to use to access the US Census, as it allows us to use simple R functions without having to use the complicated `GET()` requests described in Chapter 3.

### Exercise 2

Now that we have the package needed to access the Census database, we need to get an API key. 


An API key is basically a password for an API, but it often comes with certain restrictions. For example, the Census only allows you to collect 50 variables (or columns) from a database at a time. 

###

First, visit [https://api.census.gov/data/key_signup.html](https://api.census.gov/data/key_signup.html) and request an API key. Use your school or other organization name for the `Organization Name` field. Then, follow the steps and verify your API key through the email that it sends.

###

Copy and paste your API key into the box below. If you don't want to share your API key, change a few letters to make it invalid.

```{r api-access-2}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 3))
```

###

While an API key isn't mandatory for accessing the Census, it allows you to do more requests and use multiple computers to collect data. It's also a necessity for using the `tidycensus` package.

### Exercise 3

You may remember putting your GitHub Personal Access Token into your `.Renviron` file for safekeeping. We'll be doing the same for our Census API key, but the process looks a little bit different.

###

The **tidycensus** package makes the process much simpler. Run `census_api_key("YOUR API KEY HERE", install = TRUE)` in the Console, substituting your API key in the field.

This should save your key into your `.Renviron` file.

###

Run ``Sys.getenv("CENSUS_API_KEY")` in the Console. Copy-paste the command and the output in the space below. If you are nervous about sharing your Census API key, feel free to change it after your copy/paste it into the answer.

```{r connect-git-ex-5}
question_text(NULL,
    answer(NULL, correct = TRUE),
    allow_retry = TRUE,
    try_again_button = "Edit Answer",
    incorrect = NULL,
    options = list(nrows = 2))
```

###

This should contain your Census API key. If you want to see where the key is stored, run `usethis::edit_r_environ()` in the Console. It should open up your `.Renviron` file and show you all of the keys that you have stored there so far.

###

## Getting data from the Census API
###































###

```{r download-answers, child = "../../child_documents/download_answers.Rmd"}
```
